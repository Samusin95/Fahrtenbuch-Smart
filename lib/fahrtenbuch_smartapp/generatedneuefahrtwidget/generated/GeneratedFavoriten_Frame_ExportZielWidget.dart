import 'dart:convert';

import 'package:flutter/material.dart';
import 'package:flutter_session/flutter_session.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Ausgabe_FirmennameWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Ausgabe_PLZWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Ausgabe_StraeWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Text_FirmennameWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Text_HausnrWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Text_OrtWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Text_OrtWidget1.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Text_PLZWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedfavoritenwidget/generated/GeneratedFavoriten_Text_StraeWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedneuefahrtwidget/generated/GeneratedBGprimaryWidget5.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedneuefahrtwidget/generated/GeneratedFahrt_Text_StartHausnrWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedneuefahrtwidget/generated/GeneratedFahrt_Text_ZielOrtWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedneuefahrtwidget/generated/GeneratedFahrt_Text_ZielPLZWidget.dart';
import 'package:flutterapp/fahrtenbuch_smartapp/generatedneuefahrtwidget/generated/GeneratedFavoriten_Button_ExportZielWidget.dart';

import 'package:http/http.dart' as http;
import 'dart:async';

import 'GeneratedFahrt_Text_FirmennameStartWidget.dart';
import 'GeneratedFahrt_Text_FirmennameZielWidget.dart';
import 'GeneratedFahrt_Text_StartStraeWidget.dart';
import 'GeneratedFahrt_Text_ZielHausnrWidget.dart';
import 'GeneratedFahrt_Text_ZielStraeWidget.dart';

/* Frame Favoriten_Frame_Uebernehmen
    Autogenerated by FlutLab FTF Generator
  */
class GeneratedFavoriten_Frame_ExportZielWidget extends StatefulWidget {
  @override
  State<GeneratedFavoriten_Frame_ExportZielWidget> createState() =>
      _GeneratedFavoriten_Frame_ExportZielWidgetState();
}

class _GeneratedFavoriten_Frame_ExportZielWidgetState
    extends State<GeneratedFavoriten_Frame_ExportZielWidget> {
  @override
  Widget build(BuildContext context) {
    final ButtonStyle style = ElevatedButton.styleFrom(
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(6.0)),
        primary: Color.fromARGB(255, 58, 159, 165),
        //padding: EdgeInsets.symmetric(horizontal:  )
        textStyle: TextStyle(fontSize: 10, fontWeight: FontWeight.bold));
    return Container(
      child: new Row(
        mainAxisAlignment: MainAxisAlignment.center,
        children: <Widget>[
          Container(
              /*child: ElevatedButton(
              style: style,
              onPressed: () {},
              child: const Text("Import"),
            ),*/
              ),
          Container(
            child: ElevatedButton(
              style: style,
              onPressed: () {
                senddata(); //Funktion 1 - Daten端bertragung an die DB
                //getDataFavoriten();
                },
              child: const Text("Export"),
            ),
            /*  child: ElevatedButton(
              style: style,
              onPressed: () {},
              child: const Text("Import"),*/
          ),
          //),
        ],
      ),
    );
  }

  /// Holt sich aus der PHP Datei ein Array heraus und f端gt sie in eine Liste ein.
  /// Die Inhalte werden 端ber das Schl端sselwort herausgesucht und den Felder zugeordnet.
  /// Es wird der Token dem E-Mail Feld zugeordnet.
  Future getDataFavoriten() async{
    dynamic token = await FlutterSession().get("token");
    String url = "http://10.0.63.10/testsmart/getdataFavoriten.php?emailtoken=" + token;
    var response = await http.get(Uri.parse(url));
    if (response.statusCode == 200) {
      List<dynamic> prodList = [];
      var data = json.decode(response.body);
      for(var prod in data){
        prodList.add(prod);
      }
      favoritenfirmennamekey.currentState.favoritenfirmenname.text = data[0]["Firmenname"];
      favoritenStrassekey.currentState.favoritenstrasse.text = data[0]["Strasse"] + " " + data[0]["Hausnummer"];
      favoritenplzkey.currentState.favoritenplz.text = data[0]["Postleitzahl"];
      favoritenortkey.currentState.favoritenort.text = data[0]["Wohnort"];
    }
  }
}

Future<List> senddata() async {
  dynamic token = await FlutterSession().get("token");
  final response = await http.post(Uri.parse("http://10.0.63.10/testsmart/insertdataFavoriten.php"),
      body: {
        "emailtoken": token,
        "ffirmenname": zielFirmennamekey.currentState.zielFirmenname.text,
        "favstr": zielStrassekey.currentState.zielStrasse.text,
        "favnr": zielHausnrkey.currentState.zielHausnr.text,
        "fplz": zielPLZkey.currentState.zielPlZ.text,
        "fort": zielOrtkey.currentState.zielOrt.text,
      });
  if (response.statusCode == 200) {
    debugPrint("Data posted successfully");
  } else {
    debugPrint("Something went wrong! Status Code is: ${response.statusCode}");
  }
  ;
}




/* child: Container(
        width: 25.0,
        height: 25.0,
        child: Stack(
            clipBehavior: Clip.none, fit: StackFit.expand,
            alignment: Alignment.center,
            children: [
              Positioned(
                left: 0.0,
                top: 0.0,
                right: null,
                bottom: null,
                width: 25.0,
                height: 25.0,
                child: GeneratedBGprimaryWidget5(),
              ),
              Positioned(
                left: 0.0,
                top: 0.0,
                right: null,
                bottom: null,
                width: 24.0,
                height: 24.0,
                child: GeneratedFavoriten_Button_ExportStartadresseWidget(),
              )
            ]),
      ),*/
